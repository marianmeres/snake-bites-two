<!doctype html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="author" content="Marian Meres <marian@meres.sk>">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link href="node_modules/bootstrap/dist/css/bootstrap-reboot.min.css" rel="stylesheet">

	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Luckiest+Guy&display=swap" rel="stylesheet">

	<title>Snake bites two! Classic snake-like game for 1 or 2 players</title>

	<script async src="https://www.googletagmanager.com/gtag/js?id=UA-24912372-2"></script>
	<script>
		window.dataLayer = window.dataLayer || [];
		function gtag(){dataLayer.push(arguments);}
		gtag('js', new Date());
		gtag('config', 'UA-24912372-2');
	</script>

	<link rel="stylesheet" href="app/app.css">
	<link rel="stylesheet" href="app/components/scores.css">
	<link rel="stylesheet" href="app/components/board.css">
	<link rel="stylesheet" href="app/components/modal.css">
</head>
<body>
	<script data-name="icon_check_circle" type="application/x-ejs">
		<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-check-circle-fill" viewBox="0 0 16 16">
			<path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zm-3.97-3.03a.75.75 0 0 0-1.08.022L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-.01-1.05z"/>
		</svg>
	</script>

	<script data-name="snake_eyes" type="application/x-ejs">
		<svg xmlns="http://www.w3.org/2000/svg" x="0" y="0" width="100%" height="100%" viewBox="0, 0, 100, 100">
			<path d="M31.85,54.344 C25.585,54.344 20.506,49.265 20.506,43 C20.506,36.735 25.585,31.656 31.85,31.656 C38.115,31.656 43.194,36.735 43.194,43 C43.194,49.265 38.115,54.344 31.85,54.344 z" fill="#FFFFFF"/>
			<path d="M68.15,54.344 C61.885,54.344 56.806,49.265 56.806,43 C56.806,36.735 61.885,31.656 68.15,31.656 C74.415,31.656 79.494,36.735 79.494,43 C79.494,49.265 74.415,54.344 68.15,54.344 z" fill="#FFFFFF"/>
		</svg>
	</script>

	<noscript>This app requires javascript!</noscript>

	<div id="top">
		<h1>Snake bites two</h1>
		<p>Eat apples and lollipops. Avoid poo-poo. Enjoy!</p>
	</div>

	<div id="scores"></div>
	
	<section id="game">
		<div class="board"><div style="padding: 2rem; text-align: center">Loading, please wait...</div></div>
		<div class="modal"></div>
	</section>

	<div id="bottom">
		<p>
			Use <kbd>&larr;</kbd> <kbd>&uarr;</kbd> <kbd>&darr;</kbd> <kbd>&rarr;</kbd> for <b>player1</b>
			and <kbd>A</kbd> <kbd>W</kbd> <kbd>S</kbd> <kbd>D</kbd> for <b>player2</b>.
		</p>

		<p class='cpr'>
			<small>
				Copyright 2021 <a href="mailto:marian@meres.sk">Marian &amp; Lukáš Mereš</a>,
				source on <a href="https://github.com/marianmeres/snake-bites-two">GitHub</a>.
			</small>
		</p>
	</div>

	<script type="module">
		import { $each, $on, qs, qsa } from "./dist/utils/dom.js";
		import template from "./node_modules/lodash-es/template.js";
		import { EJS } from "./app/ejs.js";
		import { boardHTML, scores, speed, twoPlayerSwitch } from "./app/stores.js";
		import { cmpScores } from "./app/components/scores.js";
		import { cmpBoard } from "./app/components/board.js";
		import { cmpModal } from "./app/components/modal.js";
		import { initialize } from "./app/game.js";

		/* compile this landing page ejs templates (if any) *****************************/
		$each(qsa('script[type="application/x-ejs"]'), (v) => {
			if (v.dataset.name) EJS[v.dataset.name] = template(v.innerText, { variable: 'data' });
		});

		/* this page components *********************************************************/
		cmpScores(scores, { el: qs('#scores') });
		cmpBoard(boardHTML, { el: qs('#game .board') });
		cmpModal({}, { el: qs('#game .modal') });

		/* Game stuff *******************************************************************/
		twoPlayerSwitch.subscribe(initialize);
		speed.subscribe(initialize);

		// kick off now
		initialize();

		// maybe one day...
		// const $screen = qs('#screen');
		// const toggleHeroFullscreen = () => {
		// 	if (!document.fullscreenElement) {
		// 		$screen.requestFullscreen().catch(console.error);
		// 	} else {
		// 		document.exitFullscreen();
		// 	}
		// }
		// $on('#fstoggler', 'click', toggleHeroFullscreen);
		// $on($screen, 'fullscreenchange', (event) => {
		// 	if (document.fullscreenElement) {
		// 		$screen.classList.add('fullscreen');
		// 	} else {
		// 		$screen.classList.remove('fullscreen');
		// 	}
		// });

	</script>

</body>
</html>
